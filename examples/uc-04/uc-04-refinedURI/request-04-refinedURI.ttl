@prefix dcterms:       <http://purl.org/dc/terms/> .
@prefix dpv:           <https://w3id.org/dpv#> .
@prefix dpv-odrl:      <https://w3id.org/dpv/mappings/odrl#> .
@prefix ehds:          <https://w3c.github.io/dpv/2.1/legal/eu/ehds/> .
@prefix eu-gdpr:       <https://w3id.org/dpv/legal/eu/gdpr#> .
@prefix ex:            <https://example.org/> .
@prefix odrl:          <http://www.w3.org/ns/odrl/2/> .
@prefix rdf:           <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix sector-health: <https://w3id.org/dpv/sector/health#> .

ex:uc04-refinedURI-r-pseudonymisedweight-improvehealthcare-physicianDC-read-physician a odrl:Request ;
    odrl:uid ex:uc04-refinedURI-r-pseudonymisedweight-improvehealthcare-physicianDC-read-physician ;
    dcterms:description "Physician requests to read weight subset of health data for secondary use (improving healthcare) to patient with consent as legal basis. Known URI to be refined. Data must be Pseudonymised."@en ;
    odrl:permission [
        odrl:action odrl:read ;
        odrl:target [
            odrl:source ex:weight ;
            odrl:refinement [
                odrl:leftOperand dpv-odrl:DataControllerDataSource ;
                odrl:operator odrl:eq ;
                odrl:rightOperand ehds:HealthcareProvider ], [
                odrl:leftOperand odrl:dateTime ;
                odrl:operator odrl:isIn ;
                odrl:rightOperand [
                    a time:ProperInterval ;
                    time:hasBeginning ex:FirstEncounterEvent ;
                    time:hasEnd [
                        a time:ProperInterval ;
                        time:intervalAfter ex:SurgeryEvent ;
                        time:hasDurationDescription [
                            a time:DurationDescription ;
                            time:years "1"^^xsd:integer ] ] ] ] ]; # 1 year after surgery, time window activated when surgery date is recorded 
        odrl:assigner ex:patient ;
        odrl:assignee ex:physician ;
        dpv:DataController ex:physician ;
        odrl:constraint [
            odrl:leftOperand dpv-odrl:Purpose ;
            odrl:operator odrl:isAnyOf ;
            odrl:rightOperand dpv:ScientificResearch, dpv:ImproveHealthcare, sector-health:ResearchDevelopment, 
                ehds:HealthcareScientificResearch, ehds:ProvideHealthcareOfficialStatistics, ehds:PublicInterestRelatedToHealth, 
                ehds:EnsureQualitySafetyHealthcare, ehds:ProtectAgainstCrossBorderThreatsToHealth, ehds:PublicHealthSurveillance ], [
            odrl:leftOperand dpv-odrl:LegalBasis ;
            odrl:operator odrl:eq ;
            odrl:rightOperand eu-gdpr:A9-2-a ] ;
        odrl:duty [
            odrl:action [
                rdf:value dpv:Pseudonymise ;
                odrl:refinement [
                    odrl:leftOperand dpv:hasPseudonymisationTechnique ;
                    odrl:operator odrl:isAnyOf ;
                    odrl:rightOperand dpv:DeterministicPseudonymisation, dpv:MonotonicCounterPseudonymisation
                ] ] ] ] .

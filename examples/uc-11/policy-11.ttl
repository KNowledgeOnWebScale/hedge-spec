@prefix dcterms:       <http://purl.org/dc/terms/> .
@prefix dpv:           <https://w3id.org/dpv#> .
@prefix dpv-odrl:      <https://w3id.org/dpv/mappings/odrl#> .
@prefix ehds:          <https://w3c.github.io/dpv/2.1/legal/eu/ehds/> .
@prefix ex:            <https://example.org/> .
@prefix odrl:          <http://www.w3.org/ns/odrl/2/> .
@prefix odrl3proposal: <https://w3id.org/force/odrl3proposal#> .
@prefix rdf:           <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:		   <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sector-health: <https://w3id.org/dpv/sector/health#> .
@prefix xsd:           <http://www.w3.org/2001/XMLSchema#> .

ex:uc11-p-pseudonymisedweight-improvehealthcare-physicianDC-read a odrl:Set ;
    odrl:uid ex:uc11-p-pseudonymisedweight-improvehealthcare-physicianDC-read ;
    dcterms:description "Patient allows her weight subset of health data to be read for secondary use (improving healthcare). Known URI refined with dynamic values. Data must be Pseudonymised."@en ;
    odrl:permission [
        odrl:action odrl:read ;
        odrl:target [
            odrl:source ex:weight ; 
            odrl:refinement [
                odrl:leftOperand dpv-odrl:DataControllerDataSource ;
                odrl:operator odrl:eq ;
                odrl:rightOperand ehds:HealthcareProvider ], [
                odrl:leftOperand odrl:dateTime ; #DataGenerationTime
                odrl:operator odrl:gteq ;
                odrl:rightOperandReference ex:firstEncounterEvent], [
                odrl:leftOperand odrl:elapsedTime ; 
                odrl:operator odrl:lteq ;
                odrl:rightOperand "P1Y"^^xsd:duration ;
                odrl:rightOperandReference ex:surgeryEvent] ] ; 
        odrl:assigner ex:patient ;
        dpv:DataController ex:physician ;
        odrl:constraint [
            odrl:leftOperand dpv-odrl:Purpose ;
            odrl:operator odrl:isAnyOf ;
            odrl:rightOperand dpv:ScientificResearch, dpv:ImproveHealthcare, sector-health:ResearchDevelopment, 
                ehds:HealthcareScientificResearch, ehds:ProvideHealthcareOfficialStatistics, ehds:PublicInterestRelatedToHealth, 
                ehds:EnsureQualitySafetyHealthcare, ehds:ProtectAgainstCrossBorderThreatsToHealth, ehds:PublicHealthSurveillance ] ; 
        odrl:duty [
            odrl:action [
                rdf:value dpv:Pseudonymise ;
                odrl:refinement [
                    odrl:leftOperand dpv:hasPseudonymisationTechnique ;
                    odrl:operator odrl:isAnyOf ;
                    odrl:rightOperand dpv:DeterministicPseudonymisation, dpv:MonotonicCounterPseudonymisation
                ] ] ] ] .

ex:firstEncounterEvent a odrl3proposal:OperandReference ;
    odrl3proposal:reference ex:externalSource ;
    odrl3proposal:path ex:updateFirstEncounterEvent ;
    rdfs:comment "First patient-physician encounter (timestamp unknown)" .

ex:surgeryEvent a odrl3proposal:OperandReference ;
    odrl3proposal:reference ex:externalSource ;
    odrl3proposal:path ex:updateSurgeryEvent ;
    rdfs:comment "Surgery date (timestamp unknown)" .
        